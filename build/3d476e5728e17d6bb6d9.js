(()=>{"use strict";class t extends Uint8Array{constructor(){super(81)}getSymbol(t,e){return this[9*t+e]}setSymbol(t,e,o){this[9*t+e]=o}toData(){let t="";for(let e=0;e<81;e++)t+=this[e];return t}fromData(t){for(let e=0;e<81;e++)this[e]=parseInt(t[e])}}const e=document.createElement("canvas"),o=document.createElement("canvas");e.style.position="fixed",e.style.width="192px",e.style.height="192px",e.style.bottom="0px",e.style.left="0px",o.style.position="fixed",o.style.width="192px",o.style.height="192px",o.style.bottom="0px",o.style.right="0px";const n=t=>Math.round(t)+.5,l=(t,e)=>{e.width=192*window.devicePixelRatio,e.height=192*window.devicePixelRatio;const o=[[1,2,3],[4,5,6],[7,8,9]],l=e.width,i=l/3,s=i,a=.5*i,r=e.getContext("2d");r.clearRect(0,0,e.width,e.height),r.lineWidth=2*window.devicePixelRatio,r.beginPath();for(let t=0;t<=l;t+=s){const e=n(t);r.moveTo(e,0),r.lineTo(e,l),r.moveTo(0,e),r.lineTo(l,e)}r.stroke(),r.strokeStyle="black",r.font=t,r.textAlign="center",r.textBaseline="bottom",r.fillStyle="black";const d=r.measureText("0");let c=a;for(let t=0;t<3;t++,c+=s){let e=a;for(let l=0;l<3;l++,e+=s)r.fillText(o[t][l],n(e),n(c+(.5*d.actualBoundingBoxAscent-.5*d.actualBoundingBoxDescent)))}},i=[],s=document.createElement("canvas"),a="Hauss,sans-serif",r=new class{constructor(){this.canvas=s,this.grid=new t,this.startGrid=new t}setGrid(t){for(let e=0;e<9;e++){const o=t[e];for(let t=0;t<9;t++)this.startGrid[9*e+t]=o[t]}this.grid.set(this.startGrid)}resetGrid(){this.grid.set(this.startGrid)}hitDetect(t,e,o){const n=o-8,l=Math.floor((e-4)/n*9),i=Math.floor((t-4)/n*9);return l<0||i<0||l>=9||i>=9?[-1,-1]:[l,i]}draw(t,e,o){const l=s.getContext("2d");l.fillStyle="white",l.fillRect(0,0,s.width,s.height),l.strokeStyle="black";const r=s.width,d=r-8*window.devicePixelRatio,c=d/3,h=d/9;let f;t&&(l.fillStyle="cyan",l.fillRect(n(d*o/9)+1*window.devicePixelRatio,n(d*e/9)+1*window.devicePixelRatio,n(h),n(h))),l.beginPath(),l.lineWidth=8*window.devicePixelRatio,f=4*window.devicePixelRatio;for(let t=0;t<=3;t++,f+=c){const t=n(f);l.moveTo(t,0),l.lineTo(t,r),l.moveTo(0,t),l.lineTo(r,t)}l.stroke(),l.beginPath(),l.lineWidth=2*window.devicePixelRatio,f=4*window.devicePixelRatio+h;const m=2*h;for(let t=0;t<3;t++,f+=m){const t=.5;let e=Math.round(f)+t;l.moveTo(e,0),l.lineTo(e,r),l.moveTo(0,e),l.lineTo(r,e),f+=h,e=Math.floor(f)+t,l.moveTo(e,0),l.lineTo(e,r),l.moveTo(0,e),l.lineTo(r,e)}l.stroke(),l.textAlign="center",l.textBaseline="bottom",l.fillStyle="black";let y=null,u=null;f=4*window.devicePixelRatio+.5*h;let g=f;for(let t=0;t<9;t++,g+=h){let e=f;for(let o=0;o<9;o++,e+=h){const s=i[9*t+o];if(s){l.font="100 "+n(.7*h*1/3)+"px "+a,u||(u=l.measureText("0"));for(let t=0;t<3;t++)for(let o=0;o<3;o++)if(s[3*o+t]){const n=e+h*(t-1)/3*1,i=g+(.5*u.actualBoundingBoxAscent-.5*u.actualBoundingBoxDescent)+h*(o-1)/3*1,s=3*o+t+1;l.fillText(s,n,i)}}else{l.font="100 "+n(.7*h)+"px "+a,y||(y=l.measureText("0"));const i=this.grid.getSymbol(t,o);if(0===i)continue;const s=e,r=g+(.5*y.actualBoundingBoxAscent-.5*y.actualBoundingBoxDescent);l.fillText(i,n(s),n(r))}}}}};let d=0,c=0,h=!1;document.body.appendChild(e),document.body.appendChild(o),document.body.style.userSelect="none";const f=()=>{var t;r.draw(h,d,c),t="100 "+n(64*window.devicePixelRatio)+"px "+a,l(t,e),l(t,o)},m=()=>{localStorage.setItem("startGrid",r.startGrid.toData()),localStorage.setItem("grid",r.grid.toData()),localStorage.setItem("markers",JSON.stringify(i))},y=[[[5,0,0,0,0,4,0,7,2],[0,0,0,0,0,0,0,0,0],[0,0,0,6,1,3,0,0,0],[0,0,0,3,7,8,0,0,0],[0,0,0,4,0,0,0,6,3],[0,0,4,0,0,0,9,0,0],[0,9,6,0,0,0,1,0,0],[0,0,0,0,0,0,0,0,4],[0,1,0,0,0,5,3,9,0]],[[0,0,1,3,0,0,0,0,0],[0,9,0,0,2,0,0,0,0],[0,0,8,0,0,0,0,2,6],[0,0,0,0,0,9,0,0,5],[0,0,0,0,0,1,8,0,9],[0,0,0,7,3,4,0,0,0],[0,0,0,0,0,0,7,0,0],[4,7,0,0,0,0,0,9,0],[3,0,0,0,1,0,4,0,0]],[[1,0,0,2,0,0,3,0,0],[2,0,0,3,0,0,4,0,0],[3,0,0,4,0,0,5,0,0],[4,0,0,5,0,0,6,0,0],[0,0,0,0,0,0,0,0,0],[0,0,3,0,0,4,0,0,5],[0,0,4,0,0,5,0,0,6],[0,0,5,0,0,6,0,0,7],[0,0,6,0,0,7,0,0,8]],[[0,5,0,0,2,0,0,0,0],[0,0,0,6,0,0,1,0,0],[0,8,3,0,0,4,0,0,6],[0,3,9,0,8,0,7,0,0],[5,0,0,0,0,0,0,0,3],[1,0,0,0,0,9,0,0,0],[0,6,4,0,0,8,0,0,1],[9,0,0,0,0,0,0,0,0],[0,0,0,0,7,0,0,2,0]],[[0,3,0,0,4,0,0,0,0],[0,0,1,0,0,7,0,0,0],[0,0,6,0,0,0,9,4,0],[0,0,0,5,7,8,0,0,0],[0,0,0,3,0,0,2,0,0],[0,0,0,1,0,0,3,0,6],[5,8,0,0,0,0,0,3,0],[0,0,0,0,0,0,0,0,8],[7,0,0,0,1,0,0,0,5]],[[9,0,0,4,2,0,5,6,0],[0,0,7,0,0,0,0,4,0],[0,5,4,0,0,0,1,9,0],[0,0,0,8,7,1,9,0,0],[0,2,0,0,0,0,0,0,0],[0,0,0,0,0,6,4,0,0],[0,7,0,0,3,0,0,0,5],[0,0,0,0,9,0,0,0,0],[0,0,8,0,0,0,0,0,0]]];(()=>{const t=localStorage.getItem("startGrid");if(t){r.startGrid.fromData(t);const e=localStorage.getItem("grid");e&&r.grid.fromData(e);const o=localStorage.getItem("markers");if(o){const t=JSON.parse(o);i.length=0;for(const e in t)i[e]=t[e]}return!0}return!1})()||r.setGrid(y[0]),document.body.appendChild(r.canvas),r.canvas.addEventListener("click",(t=>{const e=t.target.getBoundingClientRect(),o=t.clientX-e.left,n=t.clientY-e.top,[l,i]=r.hitDetect(o,n,e.width);l<0||i<0||0===r.startGrid.getSymbol(l,i)&&(console.log(l,i),h&&d===l&&c===i?h=!1:(d=l,c=i,h=!0),f())}));const u=t=>{const e=t.target.getBoundingClientRect(),o=t.clientX-e.left,n=t.clientY-e.top,l=e.width;return[Math.floor(n/l*3),Math.floor(o/l*3)]};e.addEventListener("click",(t=>{if(!h)return;const[e,o]=u(t),n=3*e+o+1;r.grid.getSymbol(d,c)==n?r.grid.setSymbol(d,c,0):(delete i[9*d+c],r.grid.setSymbol(d,c,n),m()),f()})),o.addEventListener("click",(t=>{if(!h)return;const[e,o]=u(t),n=3*e+o;let l=i[9*d+c];l||(l=[],i[9*d+c]=l),l[n]=!l[n],f()})),window.addEventListener("focus",(()=>{console.log("onFocus"),f()})),window.addEventListener("blur",(()=>{})),addEventListener("orientationchange",(t=>{f(),console.log(t)}));const g=((t,e)=>{const o=document.createElement("select");for(const e of t){const t=document.createElement("option");t.text=e,o.appendChild(t)}return o.addEventListener("change",(()=>{(t=>{r.setGrid(y[t.selectedIndex]),m(),f()})(o)})),document.body.appendChild(o),document.body.appendChild(document.createElement("br")),o})(y.keys());g.style.position="absolute";const x=document.createElement("button");x.appendChild(document.createTextNode("X")),x.style.position="absolute",x.style.width="32px",x.style.height="32px",x.addEventListener("click",(()=>{i.length=0,r.resetGrid(),m(),f()})),document.body.appendChild(x);const p=document.createElement("button");p.appendChild(document.createTextNode(" 1 ")),p.style.position="absolute",p.style.width="48px",p.style.height="32px",p.addEventListener("click",(()=>{((t,e)=>{for(let o=0;o<81;o++)if(0===t[o]){let n=0;const l=e[o];if(!l)continue;for(let t=0;t<9;t++)if(l[t]){if(0!==n){n=-1;break}n=t+1}n>0&&(delete e[o],t[o]=n)}})(r.grid,i),f()})),document.body.appendChild(p);const w=document.createElement("button");w.appendChild(document.createTextNode("+++")),w.style.position="absolute",w.style.width="48px",w.style.height="32px",w.addEventListener("click",(()=>{i.length=0,((t,e,o=4)=>{e.length=0;for(let o=0;o<81;o++)0===t[o]&&(e[o]=[!0,!0,!0,!0,!0,!0,!0,!0,!0]);for(let n=0;n<9;n++)for(let l=0;l<9;l++){if(t.getSymbol(n,l)>0)continue;const i=9*n+l;let s=e[i];if(!s)continue;for(let e=0;e<9;e++){const o=t.getSymbol(n,e),i=t.getSymbol(e,l),a=3*Math.floor(n/3),r=3*Math.floor(l/3),d=t.getSymbol(a+Math.floor(e/3),r+e%3);o>0&&(s[o-1]=!1),i>0&&(s[i-1]=!1),d>0&&(s[d-1]=!1)}let a=0;for(let t=0;t<9;t++)s[t]&&a++;a>o&&delete e[i]}})(r.grid,i),f()})),document.body.appendChild(w),g.style.transform="translateX(-50%)",x.style.transform="translateX(-50%)",x.style.transform="translateX(-50%)",w.style.transform="translateX(-50%)",p.style.transform="translateX(-50%)",r.canvas.style.position="absolute",r.canvas.style.left="50%";const b=()=>{let t=window.innerWidth,e=window.innerHeight;t-192>e?(t-e<384&&(t-=384),r.canvas.style.top="0%",r.canvas.style.transform="translate(-50%, 0%)",p.style.bottom="384px",p.style.left="96px",w.style.bottom="336px",w.style.left="96px",g.style.bottom="288px",g.style.left="96px",x.style.bottom="240px",x.style.left="96px"):(r.canvas.style.top=e-t<192?"0%":.5*(e-192-t)+"px",e-t<384&&(e-=192),r.canvas.style.transform="translate(-50%, 0%)",w.style.bottom="128px",w.style.left="50%",p.style.bottom="88px",p.style.left="50%",g.style.bottom="48px",g.style.left="50%",x.style.bottom="8px",x.style.left="50%");const o=Math.min(t,e);r.canvas.style.width=o+"px",r.canvas.style.height=o+"px",r.canvas.width=2*Math.floor(o*window.devicePixelRatio/1),r.canvas.height=2*Math.floor(o*window.devicePixelRatio/1),f()};b(),window.addEventListener("resize",b),console.log("Version: 0.0.0"),document.body.style.color="black",document.body.style.backgroundColor="white"})();