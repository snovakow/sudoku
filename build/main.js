(()=>{"use strict";class t extends Uint8Array{constructor(){super(81)}getSymbol(t,e){return this[9*t+e]}setSymbol(t,e,o){this[9*t+e]=o}toData(){let t="";for(let e=0;e<81;e++)t+=this[e];return t}fromData(t){for(let e=0;e<81;e++)this[e]=parseInt(t[e])}}const e=document.createElement("canvas");e.style.position="absolute",e.style.width="192px",e.style.height="256px",e.style.top="0px",e.style.right="0px";let o=!1;const i=t=>Math.round(t)+.5,n=t=>{e.width=192*window.devicePixelRatio,e.height=256*window.devicePixelRatio;const n=[[1,2,3],[4,5,6],[7,8,9],["x","",o?"+":"-"]],l=e.width,s=l/3,a=s,d=.5*s,r=e.getContext("2d");r.clearRect(0,0,e.width,e.height),r.lineWidth=2*window.devicePixelRatio,r.beginPath();for(let t=0;t<=l;t+=a){const e=i(t);r.moveTo(e,0),r.lineTo(e,l),r.moveTo(0,e),r.lineTo(l,e)}r.stroke(),r.strokeStyle="black",r.font=t,r.textAlign="center",r.textBaseline="bottom",r.fillStyle="black";const c=r.measureText("0");let h=d;for(let t=0;t<4;t++,h+=a){let e=d;for(let o=0;o<3;o++,e+=a)r.fillText(n[t][o],i(e),i(h+(.5*c.actualBoundingBoxAscent-.5*c.actualBoundingBoxDescent)))}},l=[],s=document.createElement("canvas");s.style.position="absolute",s.style.bottom="0px",s.style.left="50%",s.style.transform="translateX(-50%)";const a="Hauss,sans-serif",d=new class{constructor(){this.canvas=s,this.grid=new t,this.startGrid=new t}setGrid(t){for(let e=0;e<9;e++){const o=t[e];for(let t=0;t<9;t++)this.startGrid[9*e+t]=o[t]}this.grid.set(this.startGrid)}resetGrid(){this.grid.set(this.startGrid)}hitDetect(t,e,o){const i=o-8,n=Math.floor((e-4)/i*9),l=Math.floor((t-4)/i*9);return n<0||l<0||n>=9||l>=9?[-1,-1]:[n,l]}draw(t,e,o){const n=s.getContext("2d");n.fillStyle="white",n.fillRect(0,0,s.width,s.height),n.strokeStyle="black";const d=s.width,r=d-8,c=r/3,h=r/9;let g;t&&(n.fillStyle="cyan",n.fillRect(i(r*o/9)+1*window.devicePixelRatio,i(r*e/9)+1*window.devicePixelRatio,i(h),i(h))),n.beginPath(),n.lineWidth=8*window.devicePixelRatio,g=4;for(let t=0;t<=3;t++,g+=c){const t=i(g);n.moveTo(t,0),n.lineTo(t,d),n.moveTo(0,t),n.lineTo(d,t)}n.stroke(),n.beginPath(),n.lineWidth=2*window.devicePixelRatio,g=4*window.devicePixelRatio+h;const m=2*h;for(let t=0;t<3;t++,g+=m){const t=.5;let e=Math.round(g)+t;n.moveTo(e,0),n.lineTo(e,d),n.moveTo(0,e),n.lineTo(d,e),g+=h,e=Math.floor(g)+t,n.moveTo(e,0),n.lineTo(e,d),n.moveTo(0,e),n.lineTo(d,e)}n.stroke(),n.textAlign="center",n.textBaseline="bottom",n.fillStyle="black";let f=null,u=null;g=4*window.devicePixelRatio+.5*h;let w=g;for(let t=0;t<9;t++,w+=h){let e=g;for(let o=0;o<9;o++,e+=h){const s=l[9*t+o];if(s){n.font="100 "+i(.7*h*1/3)+"px "+a,u||(u=n.measureText("0"));for(let t=0;t<3;t++)for(let o=0;o<3;o++)if(s[3*o+t]){const i=e+h*(t-1)/3*1,l=w+(.5*u.actualBoundingBoxAscent-.5*u.actualBoundingBoxDescent)+h*(o-1)/3*1,s=3*o+t+1;n.fillText(s,i,l)}}else{n.font="100 "+i(.7*h)+"px "+a,f||(f=n.measureText("0"));const l=this.grid.getSymbol(t,o);if(0===l)continue;const s=e,d=w+(.5*f.actualBoundingBoxAscent-.5*f.actualBoundingBoxDescent);n.fillText(l,i(s),i(d))}}}}};let r=0,c=0,h=!1;const g=()=>{if(d.draw(h,r,c),h){e.parentElement||document.body.appendChild(e);const t="100 "+i(64*window.devicePixelRatio)+"px "+a;n(t)}else e.parentElement&&document.body.removeChild(e)},m=()=>{localStorage.setItem("startGrid",d.startGrid.toData()),localStorage.setItem("grid",d.grid.toData()),localStorage.setItem("markers",JSON.stringify(l))},f=[[[1,0,0,2,0,0,3,0,0],[2,0,0,3,0,0,4,0,0],[3,0,0,4,0,0,5,0,0],[4,0,0,5,0,0,6,0,0],[0,0,0,0,0,0,0,0,0],[0,0,3,0,0,4,0,0,5],[0,0,4,0,0,5,0,0,6],[0,0,5,0,0,6,0,0,7],[0,0,6,0,0,7,0,0,8]],[[0,5,0,0,2,0,0,0,0],[0,0,0,6,0,0,1,0,0],[0,8,3,0,0,4,0,0,6],[0,3,9,0,8,0,7,0,0],[5,0,0,0,0,0,0,0,3],[1,0,0,0,0,9,0,0,0],[0,6,4,0,0,8,0,0,1],[9,0,0,0,0,0,0,0,0],[0,0,0,0,7,0,0,2,0]],[[0,3,0,0,4,0,0,0,0],[0,0,1,0,0,7,0,0,0],[0,0,6,0,0,0,9,4,0],[0,0,0,5,7,8,0,0,0],[0,0,0,3,0,0,2,0,0],[0,0,0,1,0,0,3,0,6],[5,8,0,0,0,0,0,3,0],[0,0,0,0,0,0,0,0,8],[7,0,0,0,1,0,0,0,5]],[[9,0,0,4,2,0,5,6,0],[0,0,7,0,0,0,0,4,0],[0,5,4,0,0,0,1,9,0],[0,0,0,8,7,1,9,0,0],[0,2,0,0,0,0,0,0,0],[0,0,0,0,0,6,4,0,0],[0,7,0,0,3,0,0,0,5],[0,0,0,0,9,0,0,0,0],[0,0,8,0,0,0,0,0,0]]];(()=>{const t=localStorage.getItem("startGrid");if(t){d.startGrid.fromData(t);const e=localStorage.getItem("grid");e&&d.grid.fromData(e);const o=localStorage.getItem("markers");if(o){const t=JSON.parse(o);l.length=0;for(const e in t)l[e]=t[e]}return!0}return!1})()||d.setGrid(f[0]);let u=!1;document.body.appendChild(d.canvas);const w=()=>{const t=Math.min(window.innerWidth,window.innerHeight);d.canvas.style.width=t+"px",d.canvas.style.height=t+"px",d.canvas.width=2*Math.floor(t*window.devicePixelRatio/1),d.canvas.height=2*Math.floor(t*window.devicePixelRatio/1),g()};w(),window.addEventListener("resize",w),d.canvas.addEventListener("click",(t=>{if(h)return h=!1,void g();const e=t.target.getBoundingClientRect(),o=t.clientX-e.left,i=t.clientY-e.top,[n,l]=d.hitDetect(o,i,e.width);n<0||l<0||0===d.startGrid.getSymbol(n,l)&&(r=n,c=l,h=!0,g())})),e.addEventListener("click",(t=>{const e=t.target.getBoundingClientRect(),s=t.clientX-e.left,f=t.clientY-e.top,w=e.width,x=Math.floor(f/w*3),p=Math.floor(s/w*3);if(3===x)if(2===p){u=!u,o=u;const t="100 "+i(44.8/.8)+"px "+a;n(t)}else 0===p&&(delete l[9*r+c],d.grid.setSymbol(r,c,0),m(),h=!1);else{const t=3*x+p;if(u){let e=l[9*r+c];e||(e=[],l[9*r+c]=e),e[t]=!e[t]}else delete l[9*r+c],d.grid.setSymbol(r,c,t+1),m(),h=!1}g()})),window.addEventListener("focus",(()=>{console.log("onFocus"),g()})),window.addEventListener("blur",(()=>{})),((t,e)=>{const o=document.createElement("select");for(const t of[0,1,2,3]){const e=document.createElement("option");e.text=t,o.appendChild(e)}o.addEventListener("change",(()=>{(t=>{d.setGrid(f[t.selectedIndex]),m(),g()})(o)})),document.body.appendChild(o),document.body.appendChild(document.createElement("br"))})();const x=document.createElement("button");x.appendChild(document.createTextNode("Clear")),x.style.position="absolute",x.style.width="64px",x.style.height="64px",x.style.top="64px",x.style.left="64px",x.addEventListener("click",(()=>{l.length=0,d.resetGrid(),m(),g()})),document.body.appendChild(x),console.log("Version: 0.0"),document.body.style.color="black",document.body.style.backgroundColor="white"})();